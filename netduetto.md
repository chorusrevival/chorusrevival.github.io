---
layout: default
title: NETDUETTO でオンライン合唱練習
---

# NETDUETTO でオンライン合唱練習

スクリーンショットはそのうち足すかもしれません…。

Zoom と同じく、[混声合唱団CADENZA](http://web.kyoto-inet.or.jp/people/tomo0726/cadenza/) での実験を元に書いています。  
まだ実験を始めたところなので、不正確なことなど色々あると思います。
ぜひ皆さん自分の団でもやってみてフィードバックしてください。

*注意：*NETDUETTOは6月頃に新サービス [SYNCROOM](https://syncroom.yamaha.com/) に移行し、秋頃にサービスを終了する予定とのことです。このページの内容が SYNCROOM でも使える保証はありません。

<!-- TOC -->

- [はじめに](#はじめに)
- [準備](#準備)
- [やってみよう！](#やってみよう)
- [設定など](#設定など)
- [ルーム連結](#ルーム連結)
- [発展：NETDUETTO と Zoom の併用](#発展netduetto-と-zoom-の併用)
- [遅延について (要調査)](#遅延について-要調査)
- [リンク](#リンク)

<!-- /TOC -->

## はじめに

[NETDUETTO](https://www.netduetto.net/) はヤマハによる低遅延のオンライン音声ミーティングシステムです．
十分なネットワーク速度があれば50ms以下の遅延で音楽セッションができるようです。

1つのルームに5人まで、2つのルームを連結することで最大10人まで1つのセッションに参加することができます。
(人数が増えると遅延が大きくなるかもしれませんが…。)

## 準備

- NETDUETTO ではイヤホン・ヘッドホンなどが(ほぼ)必須です。できるだけマイクに余計な音が入らないようにしてください。
  - Zoom などではマイク入力を後処理で色々キャンセルしています。遅延を減らす為にそういう余計なことはしないんだろうと思います。
  - Bluetoothなどの無線のイヤホン・マイクは遅延があるので**絶対に**使ってはいけません。
  
- 低遅延のためには安定したネットワーク接続が必要です。
  - 安定しない、遅延が大きい場合には色々試してみてください：
	- 無線で安定しない場合は有線で接続することを考えてもいいかもしれません。
	- 他の機器のWifiをオフにしたら改善する可能性もあります。

- [NETDUETTO のダウンロードページ](https://www.netduetto.net/download/) から自分のPC向けのものをダウンロードしてインストールしてください。

- インストール方法と使い方は [NETDUETTO のマニュアル](https://www.netduetto.net/manual/) を参照してください。

- 無事インストールできて起動できたら、設定チュートリアルに従って設定して、スピーカとマイクのテストをしましょう。
  - Windows でオーディオデバイスを「WASAPPI排他モード」にすると、他のアプリの音が鳴らなくなるのでご注意ください。その方が遅延は減るかもしれないので、試す価値はあるかも？
  
- 名前も他の人にわかるように入力しておきましょう。

## やってみよう！

インストールできたら、誰か1人がルームを作ってそこに接続しましょう。

- ルームを作るには、ルーム名とパスワードを入れて「ルームをつくる」をクリックするだけです。
  - 非公開にしたい場合は公開設定で「非公開」を選んでください。
  - ルーム接続 (後述) を使う場合は、ルーム接続される側は公開していないとできないようですので注意してください。
  
- ルームを作ったら、他の人はルーム名とパスワードを入れて「ルームに入る」をクリックしてください。公開ルームの場合は「ルーム一覧」から入ることもできます (ブラウザでルーム一覧のページが開きます)。

- それぞれの人との通信の遅延は画面に表示されます。
  - 50ms以下を目指したいところですが…。
  - あまりに遅い場合はどちらかの環境に問題がある可能性があります。

## 設定など

- 左下の「設定」ボタンを押すと自分の設定ができます。
  - 設定画面を開いている間は接続が切れますのでご注意ください。
	- 接続相手と会話をしながら設定をすることができません。

- 通常の画面内での設定項目も色々あります。
  - インプット：自分のマイクの音量を調整できます。横のミュートボタンを押すとミュートできます。
  - オーディオプレイヤー：音楽ファイルを再生して全員に共有することができます。
	- MIDI は再生できないので、mp3 などの音声ファイルに変換しておく必要があります。
  - マスターアウト：スピーカ出力の音量を調整できます。
  - 各参加者の音量・パン (左右の出力バランス) ・バッファサイズも調整できます。
	- 音量・パンは自分に聴こえるものを調整するものなので、ここの設定は他の人には影響がありません。
	- バッファサイズについては [マニュアル](https://www.netduetto.net/manual/) を参照してください。
	- ルーム入室後、右下の「詳細設定」「簡易設定」で参加者の状態や設定の表示方法が変わります。「詳細設定」にしておくことをおすすめします。	
	- 参加者の音質を下げると通信量が減るので、通信が安定したり、遅延が減ったりする可能性があります。
	  - 実際に2ルーム連結して8人程度でやっているときに、高 (44/48 kHz) → 中 (22/24 KHz)、標準圧縮 → 高圧縮にしたところ、感覚的には改善が見られました。
	  - 自分の設定は、設定の「基本音質設定」で変えられますので、そこであらかじめ下げておいてもいいのかもしれません。

## ルーム連結

- 1つのルームには5人しか入れませんが、2つのルームを連結することで10人まで同時に接続できるようになります。
  - ルームのホスト (ルームをつくった人) には画面下に「ルーム連結」というボタンが表示されています。
  - それを押すとルームの一覧が開きますので、そこから接続したいルームを選んでパスワードを入力します。
  - *公開ルームでないと一覧に現れない*ので、*連結される側のルームは公開しておく*ように注意してください。
  - 相手が許可すれば接続できます。
  - ホストが抜ける (落ちる) と接続が切れるので注意してください。

- ルーム連結では、ホストの「マスターアウト」の音が送受信されます。
  - つまり、相手ルームの音量は、全体でしか調整できません。
  - 各ルームのホストとの通信が速くて安定していることが重要になります。
  - 誰がホストをして、誰がどちらのルームに入るのが良いかは、通信環境やパートその他に大きく依存すると思いますので、色々実験してみると良いかもしれません。

## 発展：NETDUETTO と Zoom の併用

NETDUETTOでは10人までしか参加できません。

もっと多くの人に参加してもらうために、NETDUETTO でやっているセッションの音を
参加者の誰か1人が Zoom に流して、Zoom で参加している人たちはミュートしてそれを聴きながら歌ってもらう、という方法があります。

結構テクニカルなので、ある程度PCやDTMに詳しい人でないと難しいと思います。
(ハードウェア) ミキサーなどを持っていれば、それでやることもできますが、ソフトウェア的にも可能です。

- Windowsの場合
  - (管理人自身は試していないので不正確かもしれません)
  - NETDUETTO のオーディオ出力を WASAPPI 共有モードにする
  - Zoom のマイクをYAMAHA NETDUETTO Driverに設定

- Mac の場合
  - 必要なもの：
	- [BlackHole](https://github.com/ExistentialAudio/BlackHole) 
	  - [Soundflower](https://github.com/mattingalls/Soundflower/releases) でもOK.
	- [LadioCast](https://apps.apple.com/jp/app/ladiocast/id411213048?mt=12)
  - 設定の概略：
	- NETDUETTO の出力を BlackHole 16ch (または Soundflowe (2ch)) にする。
	- LadioCastを使って、BlackHole 16ch の入力を ZoomAudioDevice とイヤホン・ヘッドホンの両方に流すようにする。
	- Zoom のマイクはミュートし、共有機能で音声を共有する。
	- (うろ覚え：これだけだと自分のマイク入力が入らないかも…？)
	
これをやる人は、NETDUETTO と Zoom の両方の音声を聞くことになるので、
2つイヤホン・ヘッドホンが必要になりますし、それぞれの音量を調整できないと困ると思います。

## 遅延について (要調査)

- [公式FAQ](https://www.netduetto.net/faq/)の[Q.NETDUETTO β2 を快適に使うコツはありますか？](https://www.netduetto.net/faq/#TipsForSession)をまず読んでください。
- スピーカよりイヤホンの方が遅延が少ないです(音より電気信号の方が速いため)。
  - ということは当然マイクも口や楽器に近い方が遅延が少ないです。
  - 上にも書いていますが、もちろん有線のスピーカ・マイクを使ってください。
- 接続する人数が増えればもちろん遅延しやすくなります。
- 人によって誰がどのくらい遅延するかは違うようです。
  - ある人にはAさんの方がBさんより先に聴こえるのに、別の人にはBさんの方がAさんより先に聴こえたりする模様。
- ルーム接続すると、さらにややこしくなります。
  - ホストのマスターアウトを相手ルームに送っているので、遅延が増えます。
	- 経路：参加者 → ホスト (ここで一度ミックス) → 相手ルーム (ここでもう一度ミックス)
	  - もしかすると、「参加者 → ホスト (ここで一度ミックス) → 相手ホスト (ここでもう一度ミックス) → 相手ホスト参加者 (最後に全部ミックス)」なのかも？
- オーディオプレイヤー
  - 「相手との遅延時間を測定し、その時間の分だけ相手に先に音を送るという機能が入ってい」るそうです。
  - なので、伴奏やリズムパートなどを流してタイミングを取るのに使用すると、遅延が少なくなると思います。
  - SYNCROOM ではこの機能を使ったメトロノームも搭載されるそうです。
- 入力音のモニターに遅延を入れるのは、(公式FAQにもある通り) 歌では役に立たない気がしますが、個人差があるかもしれませんので、興味のある人は自分で試してみてください。

## リンク

- [NETDUETTOラボ](https://www.netduetto.net/)
  - 快適に使うためには、マニュアルやFAQをちゃんと読んでおくべきだと思います。
- [SYNCROOM](https://syncroom.yamaha.com/)
  - 6月から公式サービスとしてリニューアルされてこちらに移行予定とのこと。
- [JASジャーナル2020年5月号（Vol.60 No.3）](https://www.jas-audio.or.jp/journal/post12435) 
  - [オンライン遠隔合奏アプリケーション（SYNCROOM）-場に縛られる合奏活動の解放で新しい音楽文化の醸成に挑戦-](https://www.jas-audio.or.jp/jas_cms/wp-content/uploads/2020/05/202005_005-009.pdf) (PDF) という記事が載っています。
  - 技術的なことが詳しく書いてあるので、遅延について理解したい方は一読の価値があります。
